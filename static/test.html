<meta charset="utf-8">
<div>
    <textarea name="" id="" cols="30" rows="10">{"mod": "home", "act": "hello"}</textarea>
    <button id="send">Send</button>
</div>
<div id="output"></div>

<style>
    #output {
        padding: 5px;
        margin-top: 20px;
        border: 1px solid lightgray;
    }
    #output > div {
        padding: 3px;
        background: #d2d2d2;
    }
</style>

<script>

    var ws;
    var output = document.querySelector("#output");

    // 日志
    function log(msg) {
        var div = document.createElement("div");
        div.innerText = msg;
        document.querySelector("#output").appendChild(div);
    }

    // 连接
    function connect() {
        ws = new WebSocket("ws://127.0.0.1:8080/api");

        ws.onopen = function (evt) {
            log("OPEN");
        };

        ws.onclose = function (evt) {
            log("CLOSE");
            ws = null;
        };

        ws.onmessage = function (evt) {
            log("RESPONSE: " + evt.data);
        };

        ws.onerror = function (evt) {
            log("ERROR: " + evt.data);
        };
    }

    connect();
    document.querySelector("button").onclick = function () {
        ws.send(document.querySelector("textarea").value);
    }

</script>